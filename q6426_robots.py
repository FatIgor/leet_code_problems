class q6426_robots:

    def robots(self, nums, s, d):
        dirs = []
        index = 0
        count = len(s)
        while index < count:
            if s[index] == "L":
                dirs.append(-1)
            else:
                dirs.append(1)
            index += 1
        while d > 0:
            index = 0
            while index < count:
                nums[index] += dirs[index]
                index += 1
            i = 0
            while i < count - 1:
                if dirs[i] != dirs[i + 1]:
                    j = i + 1
                    while j < count:
                        if nums[i] == nums[j]:
                            dirs[i] *= -1
                            dirs[j] *= -1
                        j += 1
                i += 1
            d -= 1
        dist = 0
        i = 0
        while i < count - 1:
            j = i + 1
            while j < count:
                dist += abs(nums[i] - nums[j])
                j += 1
            i += 1
        return dist % 1000000007

    def tests(self):
        print(self.__class__.__name__)
        nums = [-2, 0, 2]
        s = "RLL"
        d = 3
        print(self.robots(nums, s, d))
        nums = [1, 0]
        s = "RL"
        d = 2
        print(self.robots(nums, s, d))
        nums=[38398, -7474, -32347, -5093, -53552, 127964, -70555, -45304, 99836, 39635, -19229, 94955, -121091, 118630,
         91000, -124745, 113646, 43238, -8167, -116302, 24770, 105469, 65055, 105454, -29189, 77704, 46164, -99321,
         -104017, -63223, -31567, -128812, 45297, -90371, -56951, 115701, -90076, 42047, -79331, 41395, -67282, -88171,
         74726, 49821, -90336, -99516, 60770, -84915, -49820, -28208, -72963, 1789, 112245, -887, -128231, 73904, 24841,
         -6595, -84648, -94607, 118281, -100682, -44177, -117557, 21776, 85635, 28684, -70789, -83326, -72548, -118319,
         92126, -56596, 6476, -104654, -120565, 122854, -36895, -6726, 86852, -93339, -53689, 74786, 125602, 87344,
         88192, -58036, 22112, -44989, -5843, -64532, -100114, 87642, 52713, -7786, -64989, -45303, -111485, 128587,
         697, 24539, 39361, -130029, -37790, 75315, -111624, 62971, -33474, 93104, 25337, 102119, 19886, -93145, 90163,
         104855, 50821, 56970, -77580, -60931, -109039, 107482, -115784, 39333, -57960, 98268, -28228, 69138, -86467,
         102783, -110434, -125498, -99507, 57643, 73140, 104958, -2029, -6089, 32160, 85469, 71055, 109207, -70100,
         -56099, 76777, -124906, 61318, 70176, 21401, -104248, -107927, -49155, 69732, -37969, 63856, 67987, 42757,
         12587, -112615, -87758, 40718, -91712, -30197, -50461, -23199, 80750, 92902, -25183, -129764, -56884, -109820,
         119788, -78410, -38374, -99778, -129639, 88520, 372, 43734, -27102, 123813, 68602, 30886, -99994, 96032, 83630,
         -15937, -49654, -74470, -99930, 59957, -74886, 93072, 129386, -100433, -38685, -89577, 12709, 26056, -44280,
         85224, -22973, -74127, 7825, -28136, 24036, -25682, 76352, -44712, -82055, 55675, -71396, -100644, -79520,
         -115369, 105591, -78364, -118582, -65242, -108648, 25784, -124750, 69858, -63179, -93030, 73825, 112578, 22729,
         -126291, 45137, -7510, 107074, 86047, -25968, -42956, -110613, 43019, 13759, 12937, 59358, -50788, -67535,
         33311, -52170, 83999, 128877, -40388, -29236, 35566, 51111, 38035, 122759, 17273, -83471, 65024, -68869, 62991,
         83443, -47082, -16210, -24073, 88433, -59828, 109104, -83374, -64965, 25126, 32489, -207, 95355, 97854, -90088,
         33430, -31503, 16307, -40676, 55269, -68677, -75606, 79171, 1492, 18797, 24018, 17973, -11178, -55544, -27483,
         84619, 85872, -127584, -68485, -54652, -42214, -113957, 38646, 40400, 101523, -1240, 117461, 106635, -44133,
         19263, 66029, 50419, -60582, -91514, 48235, -111025, -12650, 96858, 20850, -102704, 124500, -7082, -101693,
         -85891, 57388, 23230, 9126, 18001, 89920, 101584, 32693, -28782, -97946, -90177, 18365, 63653, 97084, -30746,
         -10819, -126293, -78507, -110356, -49897, -124662, 75779, 109122, 76577, 54717, -39902, -33812, 32365, 51180,
         17932, 29938, -31417, 67546, 53987, 112697, 114202, 54195, 91102, -24329, 78142, 101175, -58184, -21598, 73727,
         -49667, 60298, 115498]
        s="LLLLRRRRRLRRLLLLRLLRRLLRLLLRLLLRRRLLLLLRRRRLRRRRRRRRLLLLRLRLLLLRLLRLLRRLLRLLRLRLRRLLLLLRLLRRLLRLRRRRRRRRRLLLLRLLRLLRRLLRRLLLLLLLLRRRLRRLRLRRLRLRLRLLRRLRLRLRLLRLLRLLLLLRLRRRRRLLRLRLLLLLRLLRRRLLRLLRLLRLLRRLLLLRRLLLRRLLLLRRRLLRRLLLLRLRLRLRRLLRLRLRRRLRRRLLRLRLLRLRLRLRRRRLLLRRLLRRLLRRRRLRLLLRRLLLRLLRLRLLLLLLLRRRRLLRRLLRLRRRRLLLLLLLRLRRRLLRRLRRLRRLRLRLLLLRLRRRLLRLL"
        d=701
        print(self.robots(nums, s, d))
